{{ form_start(form) }}
{#{{ form_widget(form) }}#}
<h3>Tags</h3>
<ul id="tagList" class="tags" data-index="{{ form.tags|length > 0 ? form.tags|last.vars.name + 1 : 0 }}"
    data-prototype="{{ form_widget(form.tags.vars.prototype)|e('html_attr') }}">
    {% for tag in form.tags %}
    <li>{{ form_row(tag.name) }}</li>
    {% endfor %}
</ul>
<div class="actions form-actions">
    <a href="#" class="add_tag_list btn clr-white" data-collection-holder-class="tags">Add a tag</a>
    <button class="btn clr-white">{{ button_label|default('Save') }}</button>
</div>
<script>
    const addTagLink = document.createElement('a')
    addTagLink.classList.add('add_tag_list')
    addTagLink.href = '#'
    addTagLink.innerText = 'Add a tag'
    addTagLink.dataset.collectionHolderClass = 'tags'

    const tagsList = document.getElementById('tagList')

    const newLinkLi = document.createElement('li').append(addTagLink)

    const collectionHolder = document.querySelector('ul.tags')
    collectionHolder.appendChild(addTagLink)

    const addFormToCollection = (e) => {
        const collectionHolder = document.querySelector('.' + e.currentTarget.dataset.collectionHolderClass);

        const item = document.createElement('li');

        item.innerHTML = collectionHolder
            .dataset
            .prototype
            .replace(
                /__name__/g,
                collectionHolder.dataset.index
            );

        collectionHolder.appendChild(item);

        collectionHolder.dataset.index++;
    }

    addTagLink.addEventListener("click", addFormToCollection)
</script>
{{ form_end(form) }}